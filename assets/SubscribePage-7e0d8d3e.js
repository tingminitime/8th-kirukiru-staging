var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r;import{_ as i,M as n,R as d}from"./index-e1de3ee5.js";import{m as u,ai as c,o as h,c as m,d as p,a as b,s as f,t as y}from"./vendor-385d4c3c.js";const x={name:"SubscribePage",props:{authorId:{type:String,default:""}},data:()=>({authorPlan:null,payType:"WEBATM",payData:[],tradeInfoValue:"",tradeShaValue:"",isPaying:!1,isLoading:!0}),computed:(v=((e,t)=>{for(var a in t||(t={}))s.call(t,a)&&l(e,a,t[a]);if(r)for(var a of r(t))o.call(t,a)&&l(e,a,t[a]);return e})({},u(["userSubscribeList"])),g={returnUrl:()=>"index.html"},t(v,a(g))),created(){this.getAuthorPlanHandler()},methods:{getAuthorPlanHandler(){this.isLoading=!0,n(this.authorId).then((e=>{e.data.success?this.authorPlan=e.data.data:this.$notify({group:"error",title:"取得方案內容失敗"}),this.isLoading=!1})).catch((e=>{}))},paySubscribeHandler(){if(this.checkSub(this.authorId)||this.isPaying)return;this.isPaying=!0,this.$store.commit("SHOW_OVERLAY_LOADING");const e={main:this.authorId,payType:this.payType};d(e).then((e=>{e.data.Status?(this.tradeInfoValue=e.data.PayData.find((e=>"TradeInfo"===e.Key)).Value,this.tradeShaValue=e.data.PayData.find((e=>"TradeSha"===e.Key)).Value,this.$refs.tradeInfo.value=this.tradeInfoValue,this.$refs.tradeSha.value=this.tradeShaValue,this.$refs.subscribeSubmit.submit()):(this.$notify({group:"error",title:"連接失敗"}),this.isPaying=!1,this.$store.commit("HIDE_OVERLAY_LOADING"))})).catch((e=>{}))},checkSub(e){return this.userSubscribeList.some((t=>t.Author===e))},formatThousand:e=>String(e).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")}};var v,g;const w={class:"px-4 pt-8 pb-11 mx-auto max-w-[816px] min-h-[calc(100vh-56px-64px)] md:px-0 md:pt-16"},S={class:"mx-auto max-w-[600px] rounded-2xl border-t-8 border-t-myYellow shadow-md md:rounded-t-none md:rounded-b-2xl md:border md:border-myBrown"},P=p("div",{class:"hidden h-4 bg-myYellow md:block"},null,-1),I={key:0,class:"p-8 md:py-10 md:px-16"},O={class:"flex gap-4 items-center py-4 border-b border-myBrown"},j={class:"overflow-hidden shrink-0 w-16 h-16 rounded-full"},V={class:"object-cover object-center w-full h-full rounded-lg load",alt:""},L={class:"text-xl text-myBrown"},T={class:"py-8 mb-4"},k={class:"text-sm text-black/80 whitespace-pre-wrap"},A={class:"flex flex-col gap-8 justify-between items-center md:flex-row"},D={class:"flex relative flex-col items-center text-myBrown md:items-start"},B=p("span",{class:"absolute -top-0.5 py-1 px-2 text-xs font-bold text-white bg-red-500 rounded-lg -translate-y-full md:left-0"},"50% OFF",-1),H={class:"text-3xl font-bold"},$=p("p",{class:"text-xs"}," 每月自動扣款，僅限信用卡支付 ",-1),_={class:"grow w-full md:w-auto"},E=["disabled"],M={ref:"subscribeSubmit",class:"hidden",name:"form",action:"https://ccore.spgateway.com/MPG/mpg_gateway",method:"post"},Y=p("input",{name:"MerchantID",value:"MS132153993"},null,-1),G={ref:"tradeInfo",name:"TradeInfo"},R={ref:"tradeSha",name:"TradeSha"},F=p("input",{name:"Version",value:"1.5"},null,-1),K=p("input",{type:"submit",value:"Submit"},null,-1);var N=i(x,[["render",function(e,t,a,r,s,o){var l,i,n,d;const u=c("my-src");return h(),m("div",w,[p("div",S,[P,s.isLoading?b("v-if",!0):(h(),m("div",I,[b(" 作者資訊 "),p("div",O,[p("div",j,[f(p("img",V,null,512),[[u,{name:null==(l=s.authorPlan)?void 0:l.authorPic,folder:"Pic"}]])]),p("h2",L,y(null==(i=s.authorPlan)?void 0:i.author),1)]),b(" 方案介紹 "),p("div",T,[p("p",k,y(null==(n=s.authorPlan)?void 0:n.info),1)]),b(" 訂閱方案 "),p("div",A,[p("div",D,[B,p("p",H,y(o.formatThousand(null==(d=s.authorPlan)?void 0:d.amount))+"元 / 月 ",1),$]),p("div",_,[p("button",{type:"button",class:"w-full userPageButton",disabled:o.checkSub(a.authorId),onClick:t[0]||(t[0]=(...e)=>o.paySubscribeHandler&&o.paySubscribeHandler(...e))},y(o.checkSub(a.authorId)?"您已訂閱該作者":"確認訂閱"),9,E)])])]))]),b(" 金流 "),p("form",M,[Y,p("input",G,null,512),p("input",R,null,512),F,K],512)])}]]);export{N as default};
