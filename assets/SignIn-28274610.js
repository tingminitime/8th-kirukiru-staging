var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,i=(e,s)=>{for(var t in s||(s={}))n.call(s,t)&&o(e,t,s[t]);if(a)for(var t of a(s))r.call(s,t)&&o(e,t,s[t]);return e};import{_ as l}from"./LoadingSpin-78c9d011.js";import{_ as m}from"./FormInputText-c1565fb6.js";import{c as d,a as c}from"./object-9b840b78.js";import{s as u}from"./setLocale-c8d42d8a.js";import{g as p,H as b,r as h,ai as g,s as f,o as x,c as v,d as y,e as w,w as I,a as S,t as E,al as P,l as _,am as O,x as T,T as j,h as B,an as k}from"./vendor-385d4c3c.js";import{u as M,_ as L}from"./index-abe9143d.js";u({mixed:{default:"無效的輸入",required:"必填欄位"},string:{min:"長度不可小於 ${min}"}});const A={name:"SignInModal",components:{FormInputText:m,LoadingSpin:l},props:{isOpen:{type:Boolean,default:!1}},data:()=>({schema:d().shape({username:c().required(),password:c().min(6).required()}),showPassword:!1,username:"",rememberMe:!1,signInProcess:!1,isInvalidAniProcess:null,signInErrorMsg:""}),created(){const e=localStorage.getItem("userAccount");e&&(this.username=e,this.rememberMe=!0)},methods:(C=i(i({},p(["SET_TOKEN","SET_USER_INFO"])),b(["GET_KIRU_COLLECTIONS","GET_SUBSCRIBE_LIST"])),U={onSubmit(e){this.signInProcess=!0,this.rememberMe?localStorage.setItem("userAccount",this.username):localStorage.removeItem("userAccount"),M(e).then((e=>{this.signInProcess=!1,e.data.success?(this.$notify({group:"success",title:"登入成功",text:`歡迎回來，${e.data.data.Name}`},3e3),localStorage.setItem("kirukiruToken",e.data.token),this.SET_TOKEN(e.data.token),this.SET_USER_INFO(e.data.data),this.GET_KIRU_COLLECTIONS({nowpage:1,showcount:9999}),this.GET_SUBSCRIBE_LIST({nowpage:1,showcount:9999}),this.$router.replace(this.$store.state.recordPath)):(this.signInErrorMsg=e.data.message,this.$notify({group:"error",title:"登入失敗 !",text:`${e.data.message}`},2500))})).catch((e=>{this.signInProcess=!1,this.$notify({group:"error",title:"Error",text:`${e}`},2500)}))},onInvalidSubmit(e){this.isInvalidAniProcess=!0},usernameChange(e){this.username=e},goRegister(){this.CLOSE_LOGIN_MODAL(),this.OPEN_REGISTER_MODAL()},animationEndHandler(){this.isInvalidAniProcess=!1}},s(C,t(U)))};var C,U;const N=y("div",{class:"py-8 border-b-myBrown md:py-4 md:bg-myYellow md:border-b-2"},[y("h1",{class:"text-2xl font-bold text-center text-myBrown select-none md:text-3xl"}," 切切會員登入 ")],-1),R={class:"px-10 pb-6 bg-myGray md:pt-10"},$={class:"flex justify-end mb-6"},G=y("span",{class:"text-sm material-icons"}," visibility ",-1),H={class:"flex justify-between items-center"},V={class:"flex items-center"},F=y("label",{for:"remember-me",class:"block ml-2 text-sm font-medium text-myBrown"}," 記住帳號 ",-1),K=y("div",{class:"text-sm"},[y("a",{href:"#",class:"font-medium text-myBrown hover:text-myYellow"}," 忘記密碼 ? ")],-1),q={class:"flex justify-center py-6"},D={key:0,class:"text-red-500"},Y={class:"flex flex-col justify-center items-center"},z=["disabled"],J=T(" 立即註冊 ! ");const Q={name:"SignIn",components:{SignInModal:L(A,[["render",function(e,s,t,a,n,r){const o=m,i=l,d=h("router-link"),c=h("v-form"),u=g("invalid");return f((x(),v("div",{class:"overflow-hidden h-screen ring-myBrown md:w-96 md:h-fit md:rounded-xl md:ring-2 md:shadow-xl md:drop-shadow-2xl",onAnimationend:s[2]||(s[2]=O(((...e)=>r.animationEndHandler&&r.animationEndHandler(...e)),["stop"]))},[N,y("div",R,[w(c,{"validation-schema":n.schema,onSubmit:r.onSubmit,onInvalidSubmit:r.onInvalidSubmit},{default:I((()=>[S(" 帳號欄位 "),w(o,{focus:!0,name:"username",type:"text",label:"帳號",placeholder:"帳號",class:"mb-8","default-value":n.username,"init-value":!0,"success-message":"","onUpdate:modelValue":r.usernameChange},null,8,["default-value","onUpdate:modelValue"]),S(" 密碼欄位 "),w(o,{name:"password",type:n.showPassword?"text":"password",label:"密碼",placeholder:"密碼",class:"mb-2","success-message":""},null,8,["type"]),y("div",$,[y("button",{type:"button",class:"flex gap-2 items-center text-sm text-myBrown",onClick:s[0]||(s[0]=e=>n.showPassword=!n.showPassword)},[G,y("span",null,E(n.showPassword?"隱藏":"顯示")+"密碼",1)])]),y("div",H,[y("div",V,[f(y("input",{id:"remember-me","onUpdate:modelValue":s[1]||(s[1]=e=>n.rememberMe=e),name:"remember-me",type:"checkbox",class:"w-4 h-4 text-myBrown rounded border-gray-300 focus:ring-myYellow form-checkbox"},null,512),[[P,n.rememberMe]]),F]),K]),S(" 錯誤訊息 "),y("div",q,[n.signInErrorMsg?(x(),v("span",D,E(n.signInErrorMsg),1)):S("v-if",!0)]),S(" 登入 / 註冊 按鈕 "),y("div",Y,[y("button",{type:"submit",class:_(["relative myButtonValid button-lg",[n.signInProcess?"":"myButtonValidHover"]]),disabled:n.signInProcess},[w(i,{class:"absolute top-3 left-5 w-5 h-5 text-white align-middle",show:n.signInProcess},null,8,["show"]),y("span",null,E(n.signInProcess?"登入中...":"登入"),1)],10,z),w(d,{class:"py-1 px-4 mt-4 text-lg font-bold text-center text-myBrown underline underline-offset-4 md:hover:underline",to:{name:"SignUp"}},{default:I((()=>[J])),_:1})])])),_:1},8,["validation-schema","onSubmit","onInvalidSubmit"])])],32)),[[u,n.isInvalidAniProcess]])}]])}},W={class:"overflow-hidden h-[calc(100vh-56px-64px)] max-h-[calc(100vh-56px-64px)] md:grid md:grid-cols-2 md:gap-11"},X={class:"my-auto ml-auto"},Z=y("div",{class:"-z-10 py-4 my-auto"},[y("div",{class:"hidden overflow-hidden min-w-[464px] max-w-[500px] rounded-xl border-2 border-myBrown -translate-x-1/3 md:block"},[y("img",{class:"block object-cover w-full h-full scale-105",src:"./assets/signin-bg-5882b1fd.svg",alt:"signin background image"})])],-1);var ee=L(Q,[["render",function(e,s,t,a,n,r){return x(),v("div",W,[y("div",X,[w(j,{appear:"",mode:"out-in","enter-active-class":"transition duration-300 ease-out","enter-from-class":"transform opacity-0 translate-x-48","enter-to-class":"transform opacity-100 translate-x-0","leave-active-class":"transition duration-300 ease-in","leave-from-class":"transform opacity-100 translate-x-0","leave-to-class":"transform opacity-0 -translate-x-48"},{default:I((()=>[(x(),B(k("SignInModal")))])),_:1})]),Z])}]]);export{ee as default};
